FROM postgres:latest

ENV POSTGRES_USER=dhg503
ENV POSTGRES_PASSWORD=dhg503dhg503
ENV POSTGRES_DB=dhg503

# Copy initialization files in correct order
COPY init.sql /docker-entrypoint-initdb.d/init.sql
COPY check-customers.sh /usr/local/bin/
COPY tutorial.sql /scripts/

# Set permissions for all relevant directories and files
RUN chmod +x /usr/local/bin/check-customers.sh && \
    chmod 755 /docker-entrypoint-initdb.d/init.sql && \
    chmod 755 /scripts/tutorial.sql && \
    chmod 755 /scripts

ENTRYPOINT ["check-customers.sh"]
CMD ["postgres"]